# Web3 å­¦æ ¡æ™ºèƒ½åˆçº¦åç«¯

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Truffle Framework** çš„å®Œæ•´Web3æ•™è‚²å¹³å°æ™ºèƒ½åˆçº¦ç³»ç»Ÿï¼ŒåŒ…å«YDä»£å¸ã€å¼€å‘è€…éƒ¨ç½²å¹³å°å’Œè¯¾ç¨‹ç®¡ç†åŠŸèƒ½ã€‚**ä»…æ”¯æŒç§é’¥éƒ¨ç½²ï¼Œç¡®ä¿æœ€é«˜å®‰å…¨æ€§ã€‚**

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### YDä»£å¸ (YDToken)
- **ERC20æ ‡å‡†ä»£å¸**: ç¬¦åˆä»¥å¤ªåŠERC20æ ‡å‡†
- **æ•™å­¦å¥–åŠ±ç³»ç»Ÿ**: æ”¯æŒè¯¾ç¨‹å®Œæˆå¥–åŠ±å’Œå¹³å°éƒ¨ç½²å¥–åŠ±
- **æƒé™ç®¡ç†**: å¤šå±‚çº§æˆæƒç³»ç»Ÿï¼Œæ”¯æŒæ•™å¸ˆå’Œå¹³å°æˆæƒ
- **å®‰å…¨ç‰¹æ€§**: åŒ…å«æš‚åœã€ç‡ƒçƒ§ç­‰å®‰å…¨åŠŸèƒ½
- **ä¾›åº”é‡æ§åˆ¶**: æœ€å¤§ä¾›åº”é‡é™åˆ¶ä¸º10äº¿ä»£å¸

### å¼€å‘è€…éƒ¨ç½²å¹³å° (DeveloperDeploymentPlatform)
- **å¼€å‘è€…æ³¨å†Œ**: å¼€å‘è€…èº«ä»½éªŒè¯å’Œç®¡ç†
- **åˆçº¦éƒ¨ç½²è®°å½•**: è®°å½•æ‰€æœ‰åˆçº¦éƒ¨ç½²ä¿¡æ¯
- **è‡ªåŠ¨å¥–åŠ±åˆ†å‘**: åŸºäºGasä½¿ç”¨é‡çš„æ™ºèƒ½å¥–åŠ±è®¡ç®—
- **åˆçº¦éªŒè¯**: åˆçº¦éªŒè¯å’Œé¢å¤–å¥–åŠ±æœºåˆ¶
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡éªŒè¯æå‡æ•ˆç‡
- **å®‰å…¨é˜²æŠ¤**: ReentrancyGuard + Pausable åŒé‡ä¿æŠ¤

### è¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ (CourseManager)
- **è¯¾ç¨‹åˆ›å»º**: è®²å¸ˆå¯ä»¥åˆ›å»ºç»“æ„åŒ–è¯¾ç¨‹
- **å­¦ä¹ è¿›åº¦è·Ÿè¸ª**: å®æ—¶ç›‘æ§å­¦ç”Ÿå­¦ä¹ è¿›åº¦
- **å‰ç½®è¯¾ç¨‹ç®¡ç†**: æ”¯æŒè¯¾ç¨‹ä¾èµ–å…³ç³»
- **å¥–åŠ±æœºåˆ¶**: å®Œæˆè¯¾ç¨‹è‡ªåŠ¨è·å¾—YDä»£å¸å¥–åŠ±
- **ç« èŠ‚ç®¡ç†**: æ”¯æŒè¯¾ç¨‹ç« èŠ‚çš„å¢åˆ æ”¹æŸ¥

## ğŸ”‘ å®‰å…¨éƒ¨ç½²ç‰¹æ€§

### ä»…æ”¯æŒç§é’¥éƒ¨ç½²
- âœ… **ç§é’¥éƒ¨ç½²**: æ›´é«˜å®‰å…¨æ€§ï¼Œå‡å°‘æ”»å‡»é¢
- âœ… **æ ¼å¼éªŒè¯**: ä¸¥æ ¼çš„ç§é’¥æ ¼å¼æ£€æŸ¥
- âœ… **é”™è¯¯è¯Šæ–­**: è¯¦ç»†çš„éƒ¨ç½²é”™è¯¯åˆ†æ
- âŒ **ä¸æ”¯æŒåŠ©è®°è¯**: ç¡®ä¿éƒ¨ç½²å®‰å…¨

### éƒ¨ç½²å®‰å…¨æ£€æŸ¥
- è´¦æˆ·ä½™é¢éªŒè¯
- Gas ä»·æ ¼æ™ºèƒ½ä¼°ç®—
- ç½‘ç»œè¿æ¥çŠ¶æ€æ£€æŸ¥
- åˆçº¦å¤§å°é™åˆ¶æ£€æŸ¥

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- npm >= 8.0.0
- Truffle Framework

### 1. å®‰è£…å’Œé…ç½®
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/juzhiqiang/web3-school-backend.git
cd web3-school-backend

# å®‰è£…ä¾èµ–
npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½® PRIVATE_KEY=0xä½ çš„ç§é’¥
```

### 2. ç¼–è¯‘å’Œéƒ¨ç½²
```bash
# ç¼–è¯‘åˆçº¦
npm run compile

# æ£€æŸ¥è´¦æˆ·ä½™é¢
npm run check-balance

# éƒ¨ç½²åˆ°æµ‹è¯•ç½‘
npm run deploy:sepolia

# éªŒè¯éƒ¨ç½²
npm run verify:deployment
```

### 3. æµ‹è¯•å’ŒéªŒè¯
```bash
# è¿è¡Œæµ‹è¯•
npm run test

# éªŒè¯åˆçº¦ä»£ç 
npm run verify:all
```

## ğŸ“ éƒ¨ç½²æ–¹å¼

### æ–¹å¼ä¸€ï¼šTruffle åŸç”Ÿéƒ¨ç½² (æ¨è)
```bash
npm run deploy:sepolia    # Sepolia æµ‹è¯•ç½‘
npm run deploy:mainnet    # ä»¥å¤ªåŠä¸»ç½‘
```

### æ–¹å¼äºŒï¼šç§é’¥éƒ¨ç½²å·¥å…·
```bash
npm run deploy:privatekey              # éƒ¨ç½²åˆ° Sepolia
npm run deploy:privatekey:mainnet      # éƒ¨ç½²åˆ°ä¸»ç½‘
```

### æ–¹å¼ä¸‰ï¼šTruffle Dashboard (æœ€å®‰å…¨)
```bash
truffle dashboard         # å¯åŠ¨ Dashboard
npm run deploy:dashboard  # ä½¿ç”¨æµè§ˆå™¨é’±åŒ…éƒ¨ç½²
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡è®¾ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# å¿…éœ€é…ç½®é¡¹:
PRIVATE_KEY=0xä½ çš„ç§é’¥                    # å¿…é¡»ä»¥0xå¼€å¤´ï¼Œ66å­—ç¬¦é•¿åº¦
INFURA_PROJECT_ID=ä½ çš„Infuraé¡¹ç›®ID        # æˆ–ä½¿ç”¨ ALCHEMY_API_KEY
ETHERSCAN_API_KEY=ä½ çš„Etherscan_APIå¯†é’¥   # ç”¨äºåˆçº¦éªŒè¯
```

### æ”¯æŒçš„ç½‘ç»œ
- **æœ¬åœ°å¼€å‘**: development (localhost:8545), ganache (localhost:7545)
- **æµ‹è¯•ç½‘**: Sepolia (æ¨è), Mumbai, Arbitrum Sepolia
- **ä¸»ç½‘**: Ethereum, Polygon, Arbitrum

## ğŸ“Š ä»£å¸ç»æµæ¨¡å‹

### YDä»£å¸åˆ†é…
- **æ€»ä¾›åº”é‡**: 10äº¿ YDä»£å¸
- **å¹³å°å¥–åŠ±**: 1000ä¸‡ä»£å¸ï¼ˆä¸»ç½‘ï¼‰/ 10ä¸‡ä»£å¸ï¼ˆæµ‹è¯•ç½‘ï¼‰
- **è¯¾ç¨‹å¥–åŠ±**: 500ä¸‡ä»£å¸ï¼ˆä¸»ç½‘ï¼‰/ 5ä¸‡ä»£å¸ï¼ˆæµ‹è¯•ç½‘ï¼‰
- **å¼€å‘è€…å¥–åŠ±**: æ ¹æ®è´¡çŒ®åŠ¨æ€åˆ†é…

### å¥–åŠ±æœºåˆ¶

#### è¯¾ç¨‹å®Œæˆå¥–åŠ±
- SolidityåŸºç¡€ï¼š100 YD
- Web3 DAppå¼€å‘ï¼š200 YD
- DeFiåè®®å¼€å‘ï¼š300 YD

#### åˆçº¦éƒ¨ç½²å¥–åŠ±
- **åŸºç¡€å¥–åŠ±**: 50 YDä»£å¸
- **Gaså¥–åŠ±**: æ¯10ä¸‡Gasé¢å¤–5 YD
- **æœ€å¤§å¥–åŠ±**: 1000 YDä»£å¸ä¸Šé™

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### å¼€å‘è€…åœºæ™¯
1. **æ³¨å†Œå¼€å‘è€…è´¦æˆ·**
2. **éƒ¨ç½²æ™ºèƒ½åˆçº¦å¹¶è®°å½•**
3. **è·å¾—åŸºäºè´¡çŒ®çš„YDä»£å¸å¥–åŠ±**
4. **ç”³è¯·åˆçº¦éªŒè¯è·å¾—å¥–åŠ±å‘æ”¾**

### å­¦ç”Ÿåœºæ™¯
1. **æ³¨å†Œæ„Ÿå…´è¶£çš„è¯¾ç¨‹**
2. **æŒ‰è¿›åº¦å­¦ä¹ è¯¾ç¨‹å†…å®¹**
3. **å®Œæˆè¯¾ç¨‹è·å¾—YDä»£å¸å¥–åŠ±**
4. **ä½¿ç”¨ä»£å¸è§£é”é«˜çº§è¯¾ç¨‹**

### è®²å¸ˆåœºæ™¯
1. **åˆ›å»ºç»“æ„åŒ–è¯¾ç¨‹å†…å®¹**
2. **è·Ÿè¸ªå­¦ç”Ÿå­¦ä¹ è¿›åº¦**
3. **ç®¡ç†è¯¾ç¨‹ç« èŠ‚å’Œè¦æ±‚**
4. **è·å¾—æ•™å­¦è´¡çŒ®å¥–åŠ±**

## ğŸ› ï¸ å¼€å‘å·¥å…·

### ä¸»è¦å‘½ä»¤
```bash
# ç¼–è¯‘å’Œéƒ¨ç½²
npm run compile              # ç¼–è¯‘åˆçº¦
npm run deploy:sepolia       # éƒ¨ç½²åˆ°Sepolia
npm run verify:deployment    # éªŒè¯éƒ¨ç½²çŠ¶æ€

# æµ‹è¯•å’Œè´¨é‡
npm run test                 # è¿è¡Œæµ‹è¯•
npm run test:coverage        # æµ‹è¯•è¦†ç›–ç‡
npm run lint                 # ä»£ç æ£€æŸ¥

# å·¥å…·è„šæœ¬  
npm run check-balance        # æ£€æŸ¥è´¦æˆ·ä½™é¢
npm run size-check          # æ£€æŸ¥åˆçº¦å¤§å°
npm run estimate-gas        # Gasä¼°ç®—
```

### Truffle å‘½ä»¤
```bash
# è¿›å…¥æ§åˆ¶å°
truffle console --network sepolia

# æ‰‹åŠ¨éƒ¨ç½²
truffle migrate --network sepolia --reset

# éªŒè¯åˆçº¦
truffle run verify YDToken --network sepolia
```

## ğŸ” å®‰å…¨ç‰¹æ€§

- âœ… åŸºäºOpenZeppelinçš„å®‰å…¨åˆçº¦åº“
- âœ… é‡å…¥æ”»å‡»é˜²æŠ¤ (ReentrancyGuard)
- âœ… è®¿é—®æ§åˆ¶ (Ownable, è‡ªå®šä¹‰æƒé™)
- âœ… æ•´æ•°æº¢å‡ºä¿æŠ¤ (Solidity 0.8+)
- âœ… ç´§æ€¥æš‚åœæœºåˆ¶ (Pausable)
- âœ… å®Œæ•´çš„äº‹ä»¶æ—¥å¿—è®°å½•
- âœ… ç§é’¥éƒ¨ç½²å®‰å…¨éªŒè¯

## ğŸ§ª æµ‹è¯•è¦†ç›–

### æµ‹è¯•ç»„ä»¶
- **YDToken**: ä»£å¸åŸºç¡€åŠŸèƒ½ã€æƒé™ç®¡ç†ã€å¥–åŠ±åˆ†å‘
- **DeveloperDeploymentPlatform**: å¼€å‘è€…æ³¨å†Œã€éƒ¨ç½²è®°å½•ã€å¥–åŠ±è®¡ç®—
- **CourseManager**: è¯¾ç¨‹ç®¡ç†ã€å­¦ç”Ÿæ³¨å†Œã€è¿›åº¦è·Ÿè¸ª

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
npm run test:coverage

# Gas æ¶ˆè€—æŠ¥å‘Š
npm run test:gas
```

## ğŸ“ˆ ç›‘æ§å’Œåˆ†æ

### å¹³å°ç»Ÿè®¡
- æ€»éƒ¨ç½²æ•°é‡
- æ³¨å†Œå¼€å‘è€…æ•°é‡
- å·²åˆ†å‘å¥–åŠ±æ€»é¢
- åˆçº¦ä½™é¢çŠ¶æ€

### å­¦ä¹ æ•°æ®
- è¯¾ç¨‹æ³¨å†Œäººæ•°
- å®Œæˆç‡ç»Ÿè®¡
- å¥–åŠ±åˆ†å‘è®°å½•
- å­¦ä¹ è¿›åº¦åˆ†æ

## ğŸ›¡ï¸ å®‰å…¨æœ€ä½³å®è·µ

### ç§é’¥å®‰å…¨
- ä½¿ç”¨ç¡¬ä»¶é’±åŒ…ç”Ÿæˆç§é’¥
- ç§é’¥å¿…é¡»ä»¥ `0x` å¼€å¤´ä¸”ä¸º 66 å­—ç¬¦é•¿åº¦
- æ°¸è¿œä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ç§é’¥
- å®šæœŸè½®æ¢ç§é’¥æå‡å®‰å…¨æ€§

### éƒ¨ç½²å®‰å…¨
- æµ‹è¯•ç½‘å……åˆ†æµ‹è¯•åå†éƒ¨ç½²ä¸»ç½‘
- ä¸»ç½‘éƒ¨ç½²å‰è¿›è¡Œ dry run æ¨¡æ‹Ÿ
- ä½¿ç”¨åˆç†çš„ Gas ä»·æ ¼é¿å…æŠ¢è·‘
- éƒ¨ç½²åç«‹å³éªŒè¯åˆçº¦æºç 

### åˆçº¦å®‰å…¨
- å¯ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–å‡å°‘ Gas æ¶ˆè€—
- ä½¿ç”¨äº‹ä»¶è®°å½•é‡è¦æ“ä½œ
- å®ç°ç´§æ€¥æš‚åœæœºåˆ¶
- å®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿å‚ä¸é¡¹ç›®è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®åˆ°æ‚¨çš„GitHubè´¦æˆ·
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¯åŠ¨å‘½ä»¤

```bash
# å®Œæ•´çš„å¼€å‘ç¯å¢ƒè®¾ç½®
git clone https://github.com/juzhiqiang/web3-school-backend.git
cd web3-school-backend
npm install

# é…ç½®ç§é’¥
cp .env.example .env
# ç¼–è¾‘ .env è®¾ç½® PRIVATE_KEY=0xä½ çš„ç§é’¥

# éƒ¨ç½²åˆ°æµ‹è¯•ç½‘
npm run compile
npm run deploy:sepolia
npm run verify:deployment
```

## ğŸ“š æ–‡æ¡£èµ„æº

- **[éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md)** - è¯¦ç»†éƒ¨ç½²è¯´æ˜
- **[APIæ–‡æ¡£](docs/API.md)** - æ™ºèƒ½åˆçº¦APIå‚è€ƒ
- **[å®‰å…¨æŒ‡å—](docs/SECURITY.md)** - å®‰å…¨æœ€ä½³å®è·µ
- **[å‰ç«¯é›†æˆ](docs/FRONTEND_INTEGRATION.md)** - Web3.jsé›†æˆç¤ºä¾‹

## âš¡ æ–°æ‰‹å¿«é€Ÿä¸Šæ‰‹

```bash
# ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Ÿä¸€é”®è®¾ç½®å¼€å‘ç¯å¢ƒ
npm run setup:dev

# å·²æœ‰ç§é’¥ï¼Ÿç›´æ¥éƒ¨ç½²æµ‹è¯•
npm run start:sepolia
```

---

**ğŸ” Web3å­¦æ ¡ - ç§é’¥å®‰å…¨éƒ¨ç½²ç‰ˆ** 

è®©åŒºå—é“¾æ•™è‚²æ›´ç®€å•ã€æ›´å®‰å…¨ï¼ğŸ“âœ¨

*åŸºäº Truffle Framework æ„å»ºï¼Œä»…æ”¯æŒç§é’¥éƒ¨ç½²ï¼Œæä¾›æœ€é«˜å®‰å…¨ä¿éšœ*
